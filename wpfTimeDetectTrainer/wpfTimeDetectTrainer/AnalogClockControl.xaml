<UserControl x:Class="TimeTrainer.Controls.AnalogClockControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:TimeTrainer.Controls" 
             mc:Ignorable="d"
             d:DesignHeight="200" d:DesignWidth="200" Name="Root">
    <!-- Name="Root" используется для ElementName привязок, если нужно -->
    <!-- DataContext этого UserControl обычно устанавливается извне, когда он используется -->
    <Grid>
        <Viewbox Stretch="Uniform">
            <Canvas x:Name="ClockCanvas" Background="Transparent"
                    Width="200" Height="200"
                    MouseLeftButtonDown="ClockCanvas_MouseLeftButtonDown"
                    MouseMove="ClockCanvas_MouseMove"
                    MouseLeftButtonUp="ClockCanvas_MouseLeftButtonUp"
                    MouseWheel="ClockCanvas_MouseWheel"
                    ToolTipService.ToolTip="{Binding ToolTipContent, RelativeSource={RelativeSource AncestorType=UserControl}}"
                    ToolTipService.Placement="MousePoint">
                
                <!-- Clock Face -->
                <Ellipse Stroke="Black" StrokeThickness="2" Fill="White"
                         Width="200" Height="200" Canvas.Left="0" Canvas.Top="0"/>
                <Ellipse Stroke="#2B4182" StrokeThickness="5" Fill="Transparent"
                         Width="200" Height="200" Canvas.Left="0" Canvas.Top="0"/>

                <!-- Tick Marks (Риски) -->
                <ItemsControl ItemsSource="{Binding TickMarks, RelativeSource={RelativeSource AncestorType=UserControl}}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <Canvas />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate DataType="{x:Type local:TickMarkViewModel}">
                            <Line X1="100" X2="100" 
                                  Y1="{Binding Y1}" Y2="{Binding Y2}"
                                  Stroke="{Binding Stroke}" 
                                  StrokeThickness="{Binding Thickness}">
                                <Line.RenderTransform>
                                    <RotateTransform Angle="{Binding Angle}" CenterX="100" CenterY="100"/>
                                </Line.RenderTransform>
                            </Line>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

                <!-- Clock Numbers (Цифры) -->
                <TextBlock x:Name="Hour12Text" Text="12" Canvas.Left="88" Canvas.Top="31" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour1Text"  Text="1"  Canvas.Left="124" Canvas.Top="39" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour2Text"  Text="2"  Canvas.Left="146" Canvas.Top="61" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour3Text"  Text="3"  Canvas.Left="154" Canvas.Top="91" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour4Text"  Text="4"  Canvas.Left="146" Canvas.Top="121" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour5Text"  Text="5"  Canvas.Left="124" Canvas.Top="143" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour6Text"  Text="6"  Canvas.Left="94" Canvas.Top="151" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour7Text"  Text="7"  Canvas.Left="64" Canvas.Top="143" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour8Text"  Text="8"  Canvas.Left="42" Canvas.Top="121" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour9Text"  Text="9"  Canvas.Left="34" Canvas.Top="91" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour10Text" Text="10" Canvas.Left="36" Canvas.Top="61" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>
                <TextBlock x:Name="Hour11Text" Text="11" Canvas.Left="58" Canvas.Top="39" FontSize="16" FontWeight="Bold" FontFamily="Segoe UI"/>

                <!-- Hour Hand (Часовая стрелка) -->
                <Line x:Name="HourHand" Stroke="Black" StrokeThickness="4" StrokeStartLineCap="Round" StrokeEndLineCap="Round"
                      X1="100" Y1="100" X2="100" Y2="50"> 
                    <Line.RenderTransform>
                        <RotateTransform Angle="{Binding HourAngle, RelativeSource={RelativeSource AncestorType=UserControl}}" CenterX="100" CenterY="100"/>
                    </Line.RenderTransform>
                </Line>

                <!-- Minute Hand (Минутная стрелка) -->
                <Line x:Name="MinuteHand" Stroke="Blue" StrokeThickness="3" StrokeStartLineCap="Round" StrokeEndLineCap="Round"
                      X1="100" Y1="100" X2="100" Y2="25"> 
                    <Line.RenderTransform>
                        <RotateTransform Angle="{Binding MinuteAngle, RelativeSource={RelativeSource AncestorType=UserControl}}" CenterX="100" CenterY="100"/>
                    </Line.RenderTransform>
                </Line>

                <!-- Center Pivot (Центральная точка) -->
                <Ellipse Fill="DarkGray" Width="10" Height="10" Canvas.Left="95" Canvas.Top="95"/>
            </Canvas>
        </Viewbox>
    </Grid>
</UserControl>